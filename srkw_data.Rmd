---
title: "SRKW Data"
output: html_notebook
---

```{r}
library(aninet)
```

```{r}
X <- srkw_contact
D <- srkw_sampling

summary <- social_differentiation(X, D, method="Negative-binomial", directed=FALSE)
summary
```

```{r}
n <- dim(X)[1] # Number of individuals
s <- summary[4, 1] # Social differentiation
mu <- mean(X[upper.tri(X)]) # Mean number of interactions

r <- 0.5 # Effect size in the true network.

power_nodal_interaction(n, r, s, mu, D, num_iters = 200)
```

```{r}
correlation_elbow_interaction(s, 0.99)
```

```{r}
for (r in c(0.1, 0.3, 0.5, 0.7, 0.9)) {
  power <- power_analysis_nodal(n, r, s, mu, D, num_iters = 200, node_metric = "strength")
  cat(paste("Effect size (r):", r, " Power (%):", round(power * 100, 0), "\n"))
}
```
